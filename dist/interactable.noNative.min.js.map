{"version":3,"file":"interactable.noNative.min.js","sources":["../playground/src/react-interactable/Utils.js","../playground/src/react-interactable/Behaviors.js","../playground/src/react-interactable/InteractableView.js","../playground/src/react-interactable/Animator.js","../playground/src/react-interactable/noNative.js","../playground/src/react-interactable/AnimatedView.js"],"sourcesContent":["export default {\r\n\tcreateArea: function( boundaries ){\r\n\t\treturn {\r\n\t\t\tminPoint: {\r\n\t\t\t\tx: boundaries.left === undefined ? -Infinity : boundaries.left,\r\n\t\t\t\ty: boundaries.top === undefined ? -Infinity : boundaries.top\r\n\t\t\t},\r\n\t\t\tmaxPoint: {\r\n\t\t\t\tx: boundaries.right === undefined ? Infinity : boundaries.right,\r\n\t\t\t\ty: boundaries.bottom === undefined ? Infinity : boundaries.bottom\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcreateAreaFromRadius: function( radius, anchor ){\r\n\t\treturn {\r\n\t\t\tminPoint: {x: anchor.x - radius, y: anchor.y - radius},\r\n\t\t\tmaxPoint: {x: anchor.x + radius, y: anchor.y + radius}\r\n\t\t}\r\n\t},\r\n\tisPointInArea: function( {x, y}, area ){\r\n\t\tif( !area ) return true\r\n\r\n\t\tlet { minPoint, maxPoint } = area\r\n\r\n\t\treturn x>=minPoint.x && x <= maxPoint.x && y >= minPoint.y && y <= maxPoint.y\r\n\t},\r\n\tfindClosest: function( origin, points ){\r\n\t\tlet minDistance = Infinity;\r\n\t\tlet closestPoint = null;\r\n\t\tlet distances = []\r\n\t\tpoints.forEach( point => {\r\n\t\t\tlet distance = this.getDistance( point, origin );\r\n\t\t\tdistances.push( distance )\r\n\t\t\tif (distance < minDistance) {\r\n\t\t\t\tminDistance = distance;\r\n\t\t\t\tclosestPoint = point;\r\n\t\t\t}\r\n\t\t})\r\n\t\t// console.log( distances )\r\n\t\treturn closestPoint\r\n\t},\r\n\tgetDistance( point, relative ){\r\n\t\tlet p = {x: point.x === undefined ? Infinity : point.x, y: point.y === undefined ? Infinity : point.y }\r\n\t\tlet r = {x: relative.x === undefined ? Infinity : relative.x, y: relative.y === undefined ? Infinity : relative.y }\r\n\t\tif( p.x === Infinity && p.y === Infinity ) return Infinity\r\n\t\tlet dx = p.x === Infinity ? 0 : Math.abs(r.x - p.x)\r\n\t\tlet dy = p.y === Infinity ? 0 : Math.abs(r.y - p.y)\r\n\t\t\r\n\t\treturn Math.sqrt( dx*dx + dy*dy )\r\n\t},\r\n\tgetDelta( point, origin ){\r\n\t\treturn {\r\n\t\t\tx: point.x - origin.x,\r\n\t\t\ty: point.y - origin.y\r\n\t\t}\r\n\t}\r\n}","import Utils from './Utils'\r\n\r\nfunction def( value, defaultValue ){\r\n\treturn value === undefined ? defaultValue : value\r\n}\r\n\r\nexport default {\r\n\tanchor: {\r\n\t\tcreate: (options, isTemp = false) => (\r\n\t\t\t{ x0: options.x, y0: options.y, priority: 1, isTemp, type: 'anchor' }\r\n\t\t),\r\n\t\tdoFrame: (options, deltaTime, state, coords ) => {\r\n\t\t\t// Velocity = dx / deltaTime\r\n\t\t\tstate.vx = (options.x0 - coords.x) / deltaTime\r\n\t\t\tstate.vy = (options.y0 - coords.y) / deltaTime\r\n\t\t}\r\n\t},\r\n\r\n\tbounce: {\r\n\t\tcreate: (options, isTemp = false) => ({\r\n\t\t\ttype: 'bounce',\r\n\t\t\tbounce: def(options.bounce, .5),\r\n\t\t\tminPoint: options.influence.minPoint,\r\n\t\t\tmaxPoint: options.influence.maxPoint,\r\n\t\t\tpriority: 3,\r\n\t\t\tisTemp\r\n\t\t}),\r\n\t\tdoFrame: ({minPoint, maxPoint, bounce}, deltaTime, state, {x,y}, target ) => {\r\n\t\t\t// Apply limits\r\n\r\n\t\t\tif (minPoint.x > x) target.setTranslationX(minPoint.x);\r\n\t\t\tif (minPoint.y > y) target.setTranslationY(minPoint.y);\r\n\t\t\tif (maxPoint.x < x) target.setTranslationX(maxPoint.x);\r\n\t\t\tif (maxPoint.y < y) target.setTranslationY(maxPoint.y);\r\n\r\n\t\t\tlet { vx, vy } = state\r\n\r\n\t\t\tif (minPoint.x > x && vx < 0) {\r\n\t\t\t\tstate.vx = -vx * bounce\r\n\t\t\t}\r\n\t\t\tif (minPoint.y > y && vy < 0) {\r\n\t\t\t\tstate.vy= -vy * bounce\r\n\t\t\t}\r\n\t\t\tif (maxPoint.x < x && vx > 0) {\r\n\t\t\t\tstate.vx = -vx * bounce\r\n\t\t\t}\r\n\t\t\tif (maxPoint.y < y && vy > 0) {\r\n\t\t\t\tstate.vy = -vy * bounce\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tfriction: {\r\n\t\tcreate: ( options, isTemp = false ) => ({\r\n\t\t\ttype: 'friction',\r\n\t\t\tdamping: def(options.damping, .7),\r\n\t\t\tinfluence: Utils.createArea( options.influenceArea || {} ),\r\n\t\t\tpriority: 2,\r\n\t\t\tisTemp\r\n\t\t}),\r\n\t\tdoFrame: (options, deltaTime, state, coords) => {\r\n\t\t\tif( !Utils.isPointInArea( coords, options.influence) ) return;\r\n\t\t\t\r\n\t\t\tlet pow = Math.pow(options.damping, 60.0 * deltaTime)\r\n\t\t\tstate.vx = pow * state.vx\r\n\t\t\tstate.vy = pow * state.vy\r\n\t\t}\r\n\t},\r\n\r\n\tgravity: {\r\n\t\tcreate: ( options, isTemp = false ) => ({\r\n\t\t\ttype: 'gravity',\r\n\t\t\tx0: def(options.x, Infinity),\r\n\t\t\ty0: def(options.y, Infinity),\r\n\t\t\tstrength: def(options.strength, 400),\r\n\t\t\tfalloff: def(options.falloff, 40),\r\n\t\t\tdamping: def(options.damping, 0),\r\n\t\t\tinfluence: Utils.createArea(options.influenceArea || {}),\r\n\t\t\tisTemp,\r\n\t\t\tpriority: 1\r\n\t\t}),\r\n\t\tdoFrame: (options, deltaTime, state, coords) => {\r\n\t\t\tif( !Utils.isPointInArea( coords, options.influence) ) return;\r\n\r\n\t\t\tlet dx = options.x0 !== Infinity ? coords.x - options.x0 : 0;\r\n\t\t\tlet dy = options.y0 !== Infinity ? coords.y - options.y0 : 0;\r\n\t\t\tlet dr = Math.sqrt(dx * dx + dy * dy);\r\n\r\n\t\t\tif (!dr) return;\r\n\r\n\t\t\tlet { falloff, strength } = options\r\n\t\t\tlet a = (-strength * dr * Math.exp(-0.5 * (dr * dr) / (falloff * falloff))) / state.mass;\r\n\r\n\t\t\tlet ax = dx / dr * a;\r\n\t\t\tlet ay = dy / dr * a;\r\n\r\n\t\t\tstate.vx += deltaTime * ax\r\n\t\t\tstate.vy += deltaTime * ay\r\n\t\t}\r\n\t},\r\n\r\n\tspring: {\r\n\t\tcreate: ( options, isTemp = false ) => ({\r\n\t\t\ttype: 'spring',\r\n\t\t\tx0: def(options.x, 0),\r\n\t\t\ty0: def(options.y, 0),\r\n\t\t\ttension: def(options.tension, 300),\r\n\t\t\tinfluence: Utils.createArea( options.influenceArea || {} ),\r\n\t\t\tisTemp,\r\n\t\t\tpriority: 1\r\n\t\t}),\r\n\t\tdoFrame: ( options, deltaTime, state, coords) => {\r\n\t\t\tif( !Utils.isPointInArea( coords, options.influence) ) return;\r\n\t\r\n\t\t\tlet dx = coords.x - options.x0;\r\n\t\t\tif( dx ){\r\n\t\t\t\t// time * acceleration\r\n\t\t\t\tstate.vx += deltaTime * ((-1 * options.tension * dx) / state.mass)\r\n\t\t\t}\r\n\t\r\n\t\t\tlet dy = coords.y - options.y0;\r\n\t\t\tif( dy ){\r\n\t\t\t\t// time * acceleration\r\n\t\t\t\tstate.vy += deltaTime * ((-1 * options.tension * dy) / state.mass)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import React, { Component } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport Animator from './Animator'\r\nimport Utils from './Utils';\r\n\r\nconst propBehaviors = {\r\n\tfrictionAreas: 'friction',\r\n\tgravityPoints: 'gravity',\r\n\tspringPoints: 'spring',\r\n}\r\n\r\nconst isWeb = typeof document !== 'undefined'\r\n\r\nexport default function injectDependencies( Animated, PanResponder ){\r\n\r\n\treturn class InteractableView extends Component {\r\n\t\tstatic propTypes = {\r\n\t\t\tsnapPoints: PropTypes.array,\r\n\t\t\tfrictionAreas: PropTypes.array,\r\n\t\t\talertAreas: PropTypes.array,\r\n\t\t\tgravityPoints: PropTypes.array,\r\n\t\t\thorizontalOnly: PropTypes.bool,\r\n\t\t\tverticalOnly: PropTypes.bool,\r\n\t\t\tdragWithSpring: PropTypes.object,\r\n\t\t\tdragEnabled: PropTypes.bool,\r\n\t\t\tanimatedValueX: PropTypes.instanceOf(Animated.Value),\r\n\t\t\tanimatedValueY: PropTypes.instanceOf(Animated.Value),\r\n\t\t\tonSnap: PropTypes.func,\r\n\t\t\tonSnapStart: PropTypes.func,\r\n\t\t\tonEnd: PropTypes.func,\r\n\t\t\tonDrag: PropTypes.func,\r\n\t\t\tboundaries: PropTypes.object,\r\n\t\t\tinitialPosition: PropTypes.object,\r\n\t\t\tdragToss: PropTypes.number\r\n\t\t}\r\n\r\n\t\tstatic defaultProps = {\r\n\t\t\tsnapPoints: [],\r\n\t\t\tfrictionAreas: [],\r\n\t\t\talertAreas: [],\r\n\t\t\tgravityPoints: [],\r\n\t\t\tboundaries: {},\r\n\t\t\tinitialPosition: {x: 0, y: 0},\r\n\t\t\tdragToss: .1,\r\n\t\t\tdragEnabled: true,\r\n\t\t\tonSnap: function () { },\r\n\t\t\tonSnapStart: function () { },\r\n\t\t\tonStop: function () { },\r\n\t\t\tonDrag: function () { },\r\n\t\t\tonAlert: function () { },\r\n\t\t\tstyle: {}\r\n\t\t}\r\n\r\n\t\tinitialPositionSet = false\r\n\t\tisDragging = false\r\n\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props)\r\n\r\n\t\t\tlet { x=0, y=0 } = props.initialPosition\r\n\r\n\t\t\t// In case animatedValueXY is not given\r\n\t\t\tthis.animated = new Animated.ValueXY({x, y})\r\n\r\n\t\t\t// This guy will apply all the physics\r\n\t\t\tthis.animator = this.createAnimator( props )\r\n\r\n\t\t\t// Cache when the view is inside of an alert area\r\n\t\t\tthis.insideAlertAreas = {}\r\n\r\n\t\t\t// cache calculated areas\r\n\t\t\tthis.propAreas = {\r\n\t\t\t\talert: [],\r\n\t\t\t\tboundaries: false\r\n\t\t\t}\r\n\r\n\t\t\tthis._pr = this.createPanResponder(props)\r\n\t\t\t\r\n\t\t\t// Set behaviors and prop defaults\r\n\t\t\tthis.setPropBehaviours( {}, props )\r\n\r\n\t\t\t// Set initial position\r\n\t\t\tlet animated  = this.getAnimated( props )\r\n\t\t\tanimated.x.setValue( x )\r\n\t\t\tanimated.y.setValue(y)\r\n\t\t\tanimated.x._startingValue = x\r\n\t\t\tanimated.y._startingValue = y\r\n\t\t\t\r\n\t\t\t// Save the last animation end position to report good coordinates in the events\r\n\t\t\tthis.lastEnd = {...this.initialPosition}\r\n\t\t}\r\n\r\n\t\trender() {\r\n\t\t\tlet { x, y } = this.getAnimated()\r\n\t\t\tlet style = this.props.style\r\n\t\t\tlet withPosition = {\r\n\t\t\t\ttransform: [{ translateX: x }, { translateY: y }].concat( style.transform || [] ),\r\n\t\t\t\t...style\r\n\t\t\t}\r\n\r\n\t\t\tlet panHandlers = this.props.dragEnabled ? this._pr.panHandlers : {}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Animated.View style={withPosition} {...panHandlers}>\r\n\t\t\t\t\t{this.props.children}\r\n\t\t\t\t</Animated.View>\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tgetTranslation(){\r\n\t\t\tlet {x, y} = this.getAnimated()\r\n\t\t\treturn {\r\n\t\t\t\tx: x._value + x._offset,\r\n\t\t\t\ty: y._value + y._offset\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tsetTranslationX( tx ){\r\n\t\t\tlet animated = this.props.animatedValueX || this.animated.x\r\n\t\t\tanimated.setValue( tx - animated._offset )\r\n\t\t}\r\n\r\n\t\tsetTranslationY(ty) {\r\n\t\t\tlet animated = this.props.animatedValueY || this.animated.y\r\n\t\t\tanimated.setValue( ty - animated._offset )\r\n\t\t}\r\n\r\n\t\tsetTranslation( tx, ty ){\r\n\t\t\tthis.setTranslationX( tx )\r\n\t\t\tthis.setTranslationY( ty )\r\n\t\t}\r\n\r\n\t\tcreateAnimator(){\r\n\t\t\treturn new Animator( this, {\r\n\t\t\t\tonAnimatorPause: () => {\r\n\t\t\t\t\tlet { x, y } = this.getTranslation()\r\n\t\t\t\t\tthis.lastEnd = {x: Math.round(x), y: Math.round(y)}\r\n\t\t\t\t\tthis.props.onStop( this.lastEnd )\r\n\t\t\t\t},\r\n\t\t\t\tonAnimationFrame: () => {\r\n\t\t\t\t\tthis.reportAlertEvent( this.getTranslation() )\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfalse // Set true or behavior type to output debug info in the console\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\tanimate( dx, dy ){\r\n\t\t\tif(!dx && !dy) return\r\n\t\t\t// let animated = this.getAnimated()\r\n\t\t\t// console.log( dx + animated.x._value + animated.x._offset )\r\n\r\n\t\t\tlet {x,y}  = this.getTranslation()\r\n\t\t\tthis.setTranslation( x + dx, y + dy ) \r\n\t\t}\r\n\r\n\t\tgetAnimated( props ){\r\n\t\t\tlet { animatedValueX, animatedValueY } = (props || this.props)\r\n\r\n\t\t\treturn {\r\n\t\t\t\tx: animatedValueX || this.animated.x ,\r\n\t\t\t\ty: animatedValueY || this.animated.y\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcreatePanResponder() {\r\n\t\t\tlet capturer = this.checkResponderCapture.bind(this)\r\n\t\t\t\r\n\t\t\treturn PanResponder.create({\r\n\t\t\t\tonMoveShouldSetResponderCapture: capturer,\r\n\t\t\t\tonMoveShouldSetPanResponderCapture: capturer,\r\n\r\n\t\t\t\tonPanResponderGrant: (e, {x0, y0}) => {\t\r\n\t\t\t\t\tthis._captured = true;\r\n\t\t\t\t\tthis.startDrag( {x: x0, y: y0} )\r\n\t\t\t\t},\r\n\r\n\t\t\t\tonPanResponderMove: (e, gesture ) => {\r\n\t\t\t\t\tthis.onDragging( gesture )\r\n\t\t\t\t},\r\n\r\n\t\t\t\tonPanResponderRelease: () => {\r\n\t\t\t\t\tthis._captured = false;\r\n\t\t\t\t\tthis.endDrag()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tcheckResponderCapture( e, gesture ){\r\n\t\t\treturn this._captured || Math.abs( gesture.dx ) > 5 || Math.abs( gesture.dy ) > 5;\r\n\t\t}\r\n\r\n\t\treportAlertEvent( position ){\r\n\t\t\tlet inside = this.insideAlertAreas\r\n\t\t\tlet { onAlert } = this.props\r\n\r\n\t\t\tthis.propAreas.alert.forEach( ({ influence, id }) => {\r\n\t\t\t\tif ( !influence || !id ) return;\r\n\r\n\t\t\t\tif ( Utils.isPointInArea( position, influence ) ) {\r\n\t\t\t\t\tif ( !inside[id] ) {\r\n\t\t\t\t\t\tonAlert({id, value:\"enter\"});\r\n\t\t\t\t\t\tinside[id] = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (inside[id]) {\r\n\t\t\t\t\tonAlert({ id, value: \"leave\" });\r\n\t\t\t\t\tinside[id] = 0;\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tstartDrag( ev ){\r\n\t\t\t// Prepare the animated\r\n\t\t\tlet {x,y} = this.getAnimated()\r\n\t\t\tlet offset = {x: x._value, y: y._value}\r\n\t\t\tx.setOffset( offset.x )\r\n\t\t\ty.setOffset( offset.y )\r\n\t\t\tx.setValue( 0 )\r\n\t\t\ty.setValue( 0 )\r\n\r\n\t\t\t// Save the offset for triggering events with the right coordinates\r\n\t\t\tthis.lastEnd = offset\r\n\t\t\t// console.log( offset )\r\n\r\n\t\t\t// Set boundaries to fast access\r\n\t\t\tthis.dragBoundaries = this.propAreas.boundaries ? this.propAreas.boundaries.influence : {}\r\n\r\n\t\t\t// Prepare the animation\r\n\t\t\tthis.props.onDrag({state: 'start', x: offset.x, y: offset.y})\r\n\t\t\tthis.dragStartLocation = { x: ev.x, y: ev.y }\r\n\t\t\tthis.animator.removeTempBehaviors();\r\n\t\t\tthis.animator.isDragging = true\r\n\t\t\tthis.animator.vx = 0\r\n\t\t\tthis.animator.vy = 0\r\n\t\t\tthis.addTempDragBehavior( this.props.dragWithSpring );\r\n\r\n\t\t\t// Stop text selection\r\n\t\t\tif ( isWeb ) {\r\n\t\t\t\tlet styles = document.body.style\r\n\t\t\t\tthis.userSelectCache = styles.userSelect\r\n\t\t\t\tstyles.userSelect = \"none\"\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tonDragging({dx, dy}){\r\n\t\t\tif( !this.animator.isDragging ) return false\r\n\t\t\tif( !this.props.dragEnabled ) return this.endDrag()\r\n\r\n\t\t\tlet pos = this.lastEnd\r\n\t\t\tlet x = dx + pos.x\r\n\t\t\tlet y = dy + pos.y\r\n\t\t\t\r\n\t\t\t// console.log( this.dragBoundaries.minPoint )\r\n\r\n\t\t\tlet {minPoint, maxPoint} = this.dragBoundaries\r\n\t\t\tif( !this.props.verticalOnly ){\r\n\t\t\t\tif (minPoint) {\r\n\t\t\t\t\tif (minPoint.x > x) x = minPoint.x\r\n\t\t\t\t\tif (maxPoint.x < x) x = maxPoint.x\r\n\t\t\t\t}\r\n\t\t\t\tthis.dragBehavior.x0 = x\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.props.horizontalOnly) {\r\n\t\t\t\tif (minPoint) {\r\n\t\t\t\t\tif (minPoint.y > y) y = minPoint.y\r\n\t\t\t\t\tif (maxPoint.y < y) y = maxPoint.y\r\n\t\t\t\t}\r\n\t\t\t\tthis.dragBehavior.y0 = y\r\n\t\t\t}\r\n\r\n\t\t\t// console.log( this.dragBehavior )\r\n\t\t}\r\n\r\n\t\tendDrag(){\r\n\t\t\tthis.animator.removeTempBehaviors();\r\n\t\t\tthis.dragBehavior = null;\r\n\t\t\tthis.animator.isDragging = false\r\n\r\n\t\t\tlet { animator, horizontalOnly, verticalOnly, dragWithSprings } = this\r\n\r\n\t\t\tlet velocity = animator.getVelocity();\r\n\t\t\tif (horizontalOnly) velocity.y = 0;\r\n\t\t\tif (verticalOnly) velocity.x = 0;\r\n\t\t\t\r\n\t\t\tlet toss = (dragWithSprings && dragWithSprings.toss) || this.props.dragToss;\r\n\t\t\tlet {x,y} = this.getTranslation()\r\n\t\t\tlet projectedCenter = {\r\n\t\t\t\tx: x + toss * velocity.x,\r\n\t\t\t\ty: y + toss * velocity.y\r\n\t\t\t};\r\n\r\n\t\t\t// console.log( 'pc', projectedCenter, velocity)\r\n\t\t\tlet snapPoint = Utils.findClosest(projectedCenter, this.props.snapPoints);\r\n\t\t\tlet targetSnapPointId = (snapPoint && snapPoint.id) ||Â \"\";\r\n\r\n\t\t\tthis.props.onDrag({ state: 'end', x: x, y: y, targetSnapPointId })\r\n\r\n\t\t\tthis.addTempSnapToPointBehavior(snapPoint);\r\n\t\t\tthis.addTempBoundaries();\r\n\r\n\t\t\tlet animated = this.getAnimated()\r\n\t\t\tanimated.x.flattenOffset()\r\n\t\t\tanimated.y.flattenOffset()\r\n\r\n\t\t\t// Restore text selection\r\n\t\t\tif ( isWeb ) {\r\n\t\t\t\tdocument.body.userSelect = this.userSelectCache || ''\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taddTempDragBehavior( drag ) {\r\n\t\t\tlet pos = this.getTranslation()\r\n\r\n\t\t\tif ( !drag || drag.tension === Infinity ) {\r\n\t\t\t\tthis.dragBehavior = this.animator.addBehavior( 'anchor', pos, true )\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tpos.tension = drag.tension || 300\r\n\t\t\t\tthis.dragBehavior = this.animator.addBehavior( 'spring', pos, true )\r\n\t\t\t\tif( drag.damping ){\r\n\t\t\t\t\tthis.animator.addBehavior('friction', drag, true)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taddTempSnapToPointBehavior( snapPoint ) {\r\n\t\t\tif (!snapPoint)  return;\r\n\t\t\tlet { snapPoints, onSnap, onSnapStart } = this.props\r\n\r\n\t\t\tlet index = snapPoints.indexOf(snapPoint)\r\n\r\n\t\t\tonSnap({index, id: snapPoint.id});\r\n\t\t\tonSnapStart({index, id: snapPoint.id});\r\n\r\n\t\t\tlet springOptions = {\r\n\t\t\t\tdamping: .7,\r\n\t\t\t\ttension: 300,\r\n\t\t\t\t...snapPoint\r\n\t\t\t}\r\n\r\n\t\t\tthis.addBehavior( 'spring', springOptions, true )\r\n\t\t}\r\n\r\n\t\tsetVelocity( velocity ) {\r\n\t\t\tif ( this.dragBehavior ) return;\r\n\t\t\tthis.animator.physicsObject.vx = velocity.x\r\n\t\t\tthis.animator.physicsObject.vy = velocity.y\r\n\t\t\tthis.endDrag();\r\n\t\t}\r\n\r\n\t\tsnapTo( {index} ) {\r\n\t\t\tlet {snapPoints} = this.props;\r\n\r\n\t\t\tif( !snapPoints || index === undefined || index >= snapPoints.length ) return;\r\n\t\t\t\r\n\t\t\tthis.animator.removeTempBehaviors();\r\n\t\t\tthis.dragBehavior = null;\r\n\t\t\tlet snapPoint = snapPoints[index]\r\n\r\n\t\t\tthis.addTempSnapToPointBehavior(snapPoint);\r\n\t\t\tthis.addTempBoundaries();\r\n\t\t}\r\n\r\n\t\taddTempBoundaries(){\r\n\t\t\tlet boundaries = this.propAreas.boundaries;\r\n\t\t\tif( !boundaries ) return;\r\n\t\t\tthis.animator.addBehavior( 'bounce', boundaries, true );\r\n\t\t}\r\n\r\n\t\tchangePosition( position ) {\r\n\t\t\tif ( this.dragBehavior ) return;\r\n\r\n\t\t\tthis.setTranslation( position.x, position.y )\r\n\t\t\tthis.endDrag();\r\n\t\t}\r\n\r\n\t\tcomponentDidUpdate( prevProps ){\r\n\t\t\tthis.setPropBehaviours( prevProps, this.props )\r\n\t\t}\r\n\r\n\t\tsetPropBehaviours( prevProps, props ){\r\n\t\t\t// spring, gravity, friction\r\n\t\t\tObject.keys( propBehaviors ).forEach( prop => {\r\n\t\t\t\tif( prevProps[ prop ] !== props[ prop ] ){\r\n\t\t\t\t\tthis.animator.removeTypeBehaviors(propBehaviors[prop])\r\n\t\t\t\t\tthis.addTypeBehaviors( propBehaviors[prop], props[ prop ] )\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tif( prevProps.alertAreas !== props.alertAreas ){\r\n\t\t\t\tlet alertAreas = []\r\n\t\t\t\tprops.alertAreas.forEach( area => {\r\n\t\t\t\t\talertAreas.push({\r\n\t\t\t\t\t\tid: area.id,\r\n\t\t\t\t\t\tinfluence: Utils.createArea( area.influenceArea )\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\tthis.propAreas.alert = alertAreas\r\n\t\t\t}\r\n\r\n\t\t\tif( prevProps.boundaries !== props.boundaries ){\r\n\t\t\t\tthis.animator.removeBehavior( this.oldBoundariesBehavior )\r\n\t\t\t\tif( props.boundaries ){\r\n\t\t\t\t\tlet bounce = {\r\n\t\t\t\t\t\tbounce: props.boundaries.bounce || 0,\r\n\t\t\t\t\t\tinfluence: Utils.createArea( props.boundaries )\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.propAreas.boundaries = bounce\r\n\t\t\t\t\tthis.oldBoundariesBehavior = this.animator.addBehavior( 'bounce', bounce )\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.propAreas.boundaries = false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (!this.props.dragEnabled && prevProps.dragEnabled && this.dragBehavior ){\r\n\t\t\t\tthis.endDrag()\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\taddTypeBehaviors( type, behaviors, isTemp ){\r\n\t\t\tbehaviors.forEach( b => this.addBehavior( type, b, isTemp )\t)\r\n\t\t}\r\n\r\n\t\taddBehavior( type, behavior, isTemp ){\r\n\t\t\tthis.animator.addBehavior( type, behavior, isTemp )\r\n\t\t\tif( behavior.damping && type !== 'friction' ){\r\n\t\t\t\tlet b = this.animator.addBehavior('friction', behavior, isTemp )\r\n\t\t\t\tif( type === 'gravity' && !behavior.influenceArea ){\r\n\t\t\t\t\tb.influence = Utils.createAreaFromRadius(1.4 * (behavior.falloff || 40), behavior)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import Behaviors from './Behaviors'\r\n\r\nconst ANIMATOR_PAUSE_CONSECUTIVE_FRAMES = 10;\r\nconst ANIMATOR_PAUSE_ZERO_VELOCITY = 1.0;\r\n\r\nclass PhysicsAnimator {\r\n\tbehaviors = []\r\n\tphysicsObject = {vx: 0, vy: 0, mass: 1}\r\n\tconsecutiveFramesWithNoMovement = 0\r\n\tscreenScale = 1\r\n\tlastFrameTS = 0\r\n\tisRunning = false\r\n\tticking = false\r\n\tisDragging = false\r\n\r\n\tconstructor( View, listener, debug ){\r\n\t\tthis.View = View\r\n\t\tthis.animatorListener = listener\r\n\t\tif( !debug ){\r\n\t\t\tlet nofn = function(){}\r\n\t\t\tthis.debugStart = nofn;\r\n\t\t\tthis.debugEnd = nofn;\r\n\t\t}\r\n\t}\r\n\r\n\tdoFrame( frameTimeMillis ) {\r\n\t\tif( !this.isRunning ) return;\r\n\r\n\t\tif ( this.lastFrameTS ) {\r\n\t\t\tthis.animateFrameWithDeltaTime(\r\n\t\t\t\t(frameTimeMillis - this.lastFrameTS) * 1e-3\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.lastFrameTS = frameTimeMillis;\r\n\t\tthis.animatorListener.onAnimationFrame();\r\n\t\trequestAnimationFrame( () => this.doFrame( Date.now() ) )\r\n\t}\r\n\r\n\tdebugStart( behavior ){\r\n\t\tif( this.debug !== true && this.debug !== behavior.type ) return;\r\n\t\tthis.debugB = behavior\r\n\t\tthis.debugInitialV = {...this.physicsObject}\r\n\t}\r\n\r\n\tdebugEnd() {\r\n\t\tif (!this.debugB || (this.debug !== true && this.debug !== this.debugB.type)) return;\r\n\t\tconsole.log( `Debug ${this.debugB.type}`, {\r\n\t\t\tdvx: this.physicsObject.vx - this.debugInitialV.vx,\r\n\t\t\tdvy: this.physicsObject.vy - this.debugInitialV.vy,\r\n\t\t})\r\n\t}\r\n\t\r\n\tanimateFrameWithDeltaTime( deltaTime ) {\r\n\t\tif( !deltaTime ) return;\r\n\r\n\t\tlet { physicsObject, behaviors, View } = this\r\n\t\tlet hadMovement = false\r\n\t\tlet coords = View.getTranslation()\r\n\r\n\t\tbehaviors.forEach( behavior => {\r\n\t\t\tthis.debugStart( behavior )\r\n\t\t\tBehaviors[ behavior.type ].doFrame( behavior, deltaTime, physicsObject, coords, View )\r\n\t\t\tthis.debugEnd()\r\n\t\t})\r\n\r\n\t\tlet dx = 0;\r\n\t\tlet {vx,vy} = physicsObject\r\n\t\t\r\n\t\tif ( Math.abs(vx) > ANIMATOR_PAUSE_ZERO_VELOCITY ) {\r\n\t\t\tdx = deltaTime * vx;\r\n\t\t\thadMovement = true;\r\n\t\t}\r\n\r\n\t\tlet dy = 0;\r\n\t\tif ( Math.abs(vy) > ANIMATOR_PAUSE_ZERO_VELOCITY ) {\r\n\t\t\tdy = deltaTime * vy;\r\n\t\t\thadMovement = true;\r\n\t\t}\r\n\t\t\r\n\t\tView.animate( dx, dy )\r\n\r\n\t\tlet cfwnm = hadMovement ? 0 : this.consecutiveFramesWithNoMovement + 1\r\n\t\tthis.consecutiveFramesWithNoMovement = cfwnm\r\n\r\n\t\tif (cfwnm >= ANIMATOR_PAUSE_CONSECUTIVE_FRAMES && !this.isDragging ) {\r\n\t\t\tthis.stopRunning();\r\n\t\t\tthis.animatorListener.onAnimatorPause();\r\n\t\t}\r\n\t}\r\n\r\n\taddBehavior( type, options, isTemp ){\r\n\t\tlet b = Behaviors[ type ]\r\n\t\tif( !b ) return;\r\n\r\n\t\tlet behavior = b.create( options, isTemp )\r\n\t\tlet behaviors = this.behaviors\r\n\t\tlet idx = 0\r\n\r\n\t\twhile (behaviors.length > idx && behaviors[idx].priority <= behavior.priority) {\r\n\t\t\t++idx;\r\n\t\t}\r\n\t\tbehaviors.splice( idx, 0, behavior )\r\n\r\n\t\tthis.ensureRunning()\r\n\t\treturn behavior\r\n\t}\r\n\r\n\tremove( condition ){\r\n\t\tlet behaviors = this.behaviors\r\n\t\tlet i = behaviors.length\r\n\t\twhile( i-- > 0 ){\r\n\t\t\tif( condition(behaviors[i]) ){\r\n\t\t\t\tbehaviors.splice( i, 1 )\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tremoveBehavior( behavior ) {\r\n\t\tthis.remove( target => target === behavior )\r\n\t}\r\n\r\n\tremoveTypeBehaviors( type ){\r\n\t\tthis.remove( target => target.type === type )\r\n\t}\r\n\t\r\n\tremoveTempBehaviors(){\r\n\t\tthis.remove( target => target.isTemp )\r\n\t}\r\n\t\r\n\tgetVelocity(){ \r\n\t\treturn { x: this.physicsObject.vx, y: this.physicsObject.vy }\r\n\t}\r\n\r\n\tensureRunning() {\r\n\t\tthis.isRunning || this.startRunning()\r\n\t}\r\n\r\n\tstartRunning() {\r\n\t\tthis.isRunning = true;\r\n\t\tthis.lastFrameTS = 0;\r\n\t\tthis.consecutiveFramesWithNoMovement = 0;\r\n\t\trequestAnimationFrame( () => this.doFrame( Date.now() ) )\r\n\t}\r\n\r\n\tstopRunning() {\r\n\t\tthis.removeTempBehaviors();\r\n\t\tthis.physicsObject = {vx: 0, vy: 0, mass: this.physicsObject.mass}\r\n\t\tthis.isRunning = false;\r\n\t}\r\n}\r\n\r\nexport default PhysicsAnimator","import Animated from 'animated/lib/targets/react-dom'\r\nimport PanResponder from 'react-panresponder-web'\r\nimport injectDependencies from './InteractableView'\r\nimport AnimatedView from './AnimatedView'\r\n\r\n// Fake the Animated.View component\r\nAnimated.View = AnimatedView\r\n\r\nlet Interactable = injectDependencies( Animated, PanResponder ) \r\nexport default {View: Interactable}","import React from 'react'\r\nimport Animated from 'animated/lib/targets/react-dom'\r\n\r\nexport default function AnimatedView(props) {\r\n  let propStyles = props.style || {}\r\n  let style = { position: 'relative', display: 'flex', ...propStyles}\r\n\r\n  return (\r\n    <Animated.div {...props} style={style}>\r\n      {props.children}\r\n    </Animated.div>\r\n  )\r\n}"],"names":["createArea","boundaries","minPoint","x","undefined","left","Infinity","y","top","maxPoint","right","bottom","createAreaFromRadius","radius","anchor","isPointInArea","area","findClosest","origin","points","minDistance","closestPoint","forEach","point","distance","_this","getDistance","relative","p","r","dx","Math","abs","dy","sqrt","getDelta","def","value","defaultValue","Animated","PanResponder","create","options","isTemp","x0","y0","priority","type","doFrame","deltaTime","state","coords","vx","vy","bounce","influence","target","setTranslationX","setTranslationY","friction","damping","Utils","influenceArea","pow","gravity","strength","falloff","dr","a","exp","mass","ax","ay","spring","tension","PhysicsAnimator","View","listener","debug","animatorListener","nofn","debugStart","debugEnd","frameTimeMillis","this","isRunning","lastFrameTS","animateFrameWithDeltaTime","onAnimationFrame","requestAnimationFrame","Date","now","behavior","debugB","debugInitialV","physicsObject","console","log","dvx","dvy","behaviors","hadMovement","getTranslation","_this2","Behaviors","animate","cfwnm","consecutiveFramesWithNoMovement","isDragging","stopRunning","onAnimatorPause","b","idx","length","splice","ensureRunning","condition","i","remove","startRunning","_this3","removeTempBehaviors","propBehaviors","frictionAreas","gravityPoints","springPoints","isWeb","document","props","propStyles","style","position","display","React","div","children","initialPosition","animated","ValueXY","animator","createAnimator","insideAlertAreas","propAreas","alert","_pr","createPanResponder","setPropBehaviours","getAnimated","setValue","_startingValue","lastEnd","Component","withPosition","transform","translateX","translateY","concat","panHandlers","dragEnabled","_value","_offset","tx","animatedValueX","ty","animatedValueY","Animator","round","onStop","reportAlertEvent","setTranslation","capturer","checkResponderCapture","bind","onMoveShouldSetResponderCapture","onMoveShouldSetPanResponderCapture","onPanResponderGrant","e","_captured","startDrag","onPanResponderMove","gesture","onDragging","onPanResponderRelease","endDrag","inside","onAlert","id","ev","offset","setOffset","dragBoundaries","onDrag","dragStartLocation","addTempDragBehavior","dragWithSpring","styles","body","userSelectCache","userSelect","pos","verticalOnly","dragBehavior","horizontalOnly","dragWithSprings","velocity","getVelocity","toss","dragToss","projectedCenter","snapPoint","snapPoints","targetSnapPointId","addTempSnapToPointBehavior","addTempBoundaries","flattenOffset","drag","addBehavior","onSnap","onSnapStart","index","indexOf","springOptions","prevProps","Object","keys","prop","_this4","removeTypeBehaviors","addTypeBehaviors","alertAreas","push","removeBehavior","oldBoundariesBehavior","_this5","PropTypes","array","bool","object","instanceOf","Value","func","onEnd","number"],"mappings":"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"}